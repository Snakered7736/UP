<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ФК Анжил — Регистрация</title>

<style>
/* ================= ROOT ================= */
:root{
  --orange:#ff8a00;
  --dark:#222;
  --muted:#f3f3f3;
  --red:#d61b1b;
  --card:#2b2b2b;
  --max:1200px;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,Arial,Helvetica,sans-serif;
  background:#111;
  color:#fff;
}
a{
  color:inherit;
  text-decoration:none;
}

/* ================= AUTH LAYOUT ================= */
.auth-container{
  display:grid;
  grid-template-columns:1fr 1fr;
  min-height:100vh;
}

/* ================= LEFT COLUMN (TEXT) ================= */
.auth-left{
  background:var(--card);
  padding:60px 80px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
}

.auth-left-content{
  max-width:400px;
}

.auth-welcome{
  font-size:42px;
  font-weight:700;
  margin:0 0 20px;
  letter-spacing:2px;
  line-height:1.2;
}

.auth-description{
  font-size:18px;
  opacity:0.85;
  line-height:1.6;
}

/* ================= RIGHT COLUMN (FORM) ================= */
.auth-right{
  background:var(--orange);
  padding:60px 80px;
  display:flex;
  flex-direction:column;
  justify-content:center;
}

.logo-link{
  position:absolute;
  top:20px;
  left:20px;
}

.logo-link img{
  height:80px;
}

.auth-title{
  font-size:32px;
  margin:0 0 40px;
  letter-spacing:1px;
  text-align:center;
}

.form-group{
  margin-bottom:24px;
}

.form-input{
  width:100%;
  padding:14px 16px;
  font-size:16px;
  border:1px solid rgba(0,0,0,0.15);
  background:rgba(255,255,255,0.15);
  color:#fff;
  border-radius:4px;
  font-family:inherit;
}

.form-input::placeholder{
  color:#666;
}

.form-input:focus{
  outline:none;
  border-color:var(--card);
  background:rgba(255,255,255,0.25);
}

.form-input:focus::placeholder{
  color:#fff;
}

.btn-submit{
  width:100%;
  padding:16px;
  font-size:18px;
  font-weight:700;
  background:var(--card);
  color:#fff;
  border:none;
  border-radius:4px;
  cursor:pointer;
  margin-top:16px;
  transition:background .2s;
}

.btn-submit:hover{
  background:#1a1a1a;
}

.auth-link{
  text-align:center;
  margin-top:24px;
  font-size:16px;
}

.auth-link a{
  color:var(--card);
  font-weight:700;
  text-decoration:underline;
}

.auth-link a:hover{
  text-decoration:none;
}

.error-message{
  display:none;
  margin-top:16px;
  padding:12px;
  background:rgba(214,27,27,0.2);
  border:1px solid var(--red);
  border-radius:4px;
  text-align:center;
  color:#fff;
}

.error-message.show{
  display:block;
}
</style>

</head>
<body>

<div class="auth-container">
  <!-- ================= LEFT COLUMN: WELCOME TEXT ================= -->
  <div class="auth-left">
    <div class="auth-left-content">
      <h1 class="auth-welcome">ПРИСОЕДИНЯЙТЕСЬ К НАШЕМУ КЛУБУ!</h1>
      <p class="auth-description">
        Станьте частью семьи ФК Анжил. Регистрируйтесь, чтобы получить доступ к эксклюзивным материалам, билетам и товарам клуба.
      </p>
    </div>
  </div>

  <!-- ================= RIGHT COLUMN: FORM ================= -->
  <div class="auth-right">
    <a href="index.html" class="logo-link">
      <img src="images/v1_195.png" alt="ФК Анжил">
    </a>

    <h2 class="auth-title">Регистрация</h2>

    <form id="registerForm">
      <div class="form-group">
        <input
          type="text"
          id="contact"
          class="form-input"
          placeholder="Телефон или почта"
          required
        >
      </div>

      <div class="form-group">
        <input
          type="password"
          id="password"
          class="form-input"
          placeholder="Пароль"
          required
          minlength="6"
        >
      </div>

      <div class="form-group">
        <input
          type="password"
          id="confirmPassword"
          class="form-input"
          placeholder="Подтверждение пароля"
          required
          minlength="6"
        >
      </div>

      <button type="submit" class="btn-submit">Регистрация</button>

      <div id="errorMessage" class="error-message"></div>
    </form>

    <p class="auth-link">
      Уже есть аккаунт? <a href="login.html">Войти</a>
    </p>
  </div>
</div>

<script>
/* ================= FORM SUBMISSION ================= */
document.getElementById('registerForm').addEventListener('submit', async function(e) {
  e.preventDefault();

  const contact = document.getElementById('contact').value.trim();
  const password = document.getElementById('password').value;
  const confirmPassword = document.getElementById('confirmPassword').value;
  const errorMsg = document.getElementById('errorMessage');

  // Очищаем предыдущие ошибки
  errorMsg.classList.remove('show');

  // Проверка совпадения паролей
  if (password !== confirmPassword) {
    errorMsg.textContent = 'Пароли не совпадают!';
    errorMsg.classList.add('show');
    return;
  }

  // Проверка длины пароля
  if (password.length < 6) {
    errorMsg.textContent = 'Пароль должен быть не менее 6 символов!';
    errorMsg.classList.add('show');
    return;
  }

  const userData = {
    contact: contact,
    password: password
  };

  console.log('Регистрация пользователя:', userData);

  // Здесь будет отправка на бэкенд
  // try {
  //   const response = await fetch('http://localhost:5000/api/auth/register', {
  //     method: 'POST',
  //     headers: { 'Content-Type': 'application/json' },
  //     body: JSON.stringify(userData)
  //   });
  //
  //   if (!response.ok) {
  //     const error = await response.json();
  //     errorMsg.textContent = error.message || 'Ошибка регистрации';
  //     errorMsg.classList.add('show');
  //     return;
  //   }
  //
  //   const data = await response.json();
  //   localStorage.setItem('user', JSON.stringify(data.user));
  //   window.location.href = 'index.html';
  // } catch (err) {
  //   errorMsg.textContent = 'Ошибка подключения к серверу';
  //   errorMsg.classList.add('show');
  // }

  try {
    const response = await fetch('http://localhost:5000/api/auth/register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({contact: contact, password: password})
    });

    if (!response.ok) {
      const error = await response.json();
      errorMsg.textContent = error.error || 'Ошибка регистрации';
      errorMsg.classList.add('show');
      return;
    }

    const data = await response.json();
    localStorage.setItem('token', data.token);
    localStorage.setItem('user', JSON.stringify(data.user));
    localStorage.setItem('userRole', data.user.role);  // Сохранить роль
    alert('Регистрация успешна!');
    window.location.href = 'index.html';
  } catch (err) {
    errorMsg.textContent = 'Ошибка подключения к серверу';
    errorMsg.classList.add('show');
  }
});
</script>

</body>
</html>
